# 《A股恐慌指数项目》需求设计文档

---

## 1. 项目背景

A股市场情绪波动频繁，受宏观经济、政策、舆论影响极大。  
传统市场情绪指标主要基于价格波动，但缺乏对“舆情层面恐慌”的理解。  

本项目旨在构建一个自动化系统，综合价格数据与舆情分析，生成“恐慌指数（Fear Index）”，帮助投资者和分析师评估市场情绪变化。

---

## 2. 项目目标

- 自动采集 **A股行情数据 + 舆情数据**  
- 通过 **ETL任务** 清洗与整合数据  
- 基于价格波动、成交量及舆情情绪计算 **恐慌指数**  
- 使用 **DeepSeek API** 对市场舆情进行自然语言理解与情绪总结  
- 在 **网页端可视化展示结果**

---

## 3. 系统用户与使用场景

| 用户类型 | 需求 |
|-----------|------|
| 投资者 | 快速了解A股主要股票的恐慌程度与市场舆论方向 |
| 数据分析师 | 从数据库导出结构化恐慌数据做回测或预测 |
| 技术人员 | 查看管道运行日志、验证数据更新状态 |

---

## 4. 功能需求

### 4.1 核心功能

| 模块 | 功能描述 |
|------|-----------|
| 🧭 数据获取模块 | 每日从 Tushare 获取行情数据；爬虫抓取财经新闻、社交平台舆情数据 |
| 🧹 数据清洗模块 | Airflow 定时执行 ETL 任务，清洗、格式化、去重、异常修正 |
| 🧮 恐慌指数计算模块 | 综合波动率、成交量变化、舆情情绪，生成 0–100 量化恐慌指数 |
| 🤖 舆情分析模块 | 使用 DeepSeek API 分析舆情文本情感极性和恐慌关键词 |
| 💻 可视化模块 | 使用 Streamlit 展示右侧表格 + 搜索框 + 折线图 + AI恐慌解读 |

---

### 4.2 页面交互设计

**页面布局：**

┌──────────────────────────────────────────────┐
│                  📊 左侧：重要A股列表（表格）                  │
│ ┌────────────────────────────┐ ┌──────────────────────┐
│ │ 股票名称 │ 代码 │ 价格 │ 板块 │ 恐慌指数 │ │ │ 搜索框 🔍 │
│ └────────────────────────────┘ │                      │
│                                             │ 折线图 📈 │
│                                             │ AI恐慌分析 🤖 │
└──────────────────────────────────────────────┘

#### 模块与用户故事

| 模块 | 用户故事 | 功能需求 |
|------|-----------|-----------|
| **数据表格（左侧）** | 作为一名投资者，我希望一目了然地看到重点A股的实时恐慌指数和关键信息，以便快速掌握市场整体情绪。 | 1. **静态表格**：展示预设的重点股票清单（名称、代码、板块）。<br>2. **动态数据**：实时或近实时显示每只股票的当前价格、恐慌指数。<br>3. **视觉增强**：恐慌指数根据数值范围（0-30绿 / 30-70黄 / 70-100红）颜色编码。<br>4. **交互排序**：支持对恐慌指数、涨跌幅、价格等列升降序排序。 |
| **搜索与图表（右上方）** | 作为一名分析师，我希望通过搜索代码或名称快速定位到特定股票，并查看其恐慌指数的历史趋势图，以分析其情绪变化。 | 1. **智能搜索**：支持代码、名称拼音首字母或模糊匹配搜索，并具备自动完成功能。<br>2. **趋势可视化**：动态绘制过去30天、90天的恐慌指数折线图。<br>3. **图表交互**：支持缩放、平移，悬停显示具体日期指数值。 |
| **AI分析（右下方）** | 作为一名用户，我希望系统能自动为我选中的股票生成一份简洁易懂的恐慌原因分析，告诉我“为什么”。 | 1. **AI集成**：调用 DeepSeek API，传入股票相关数据（价格、成交量、历史指数等）。<br>2. **文本生成**：生成连贯文本，从技术面、资金面、舆情面总结恐慌原因。 |

---

### 用户操作流程

1️⃣ 打开网页  
2️⃣ 查看表格中主要股票恐慌指数  
3️⃣ 输入股票代码  
4️⃣ 查看该股票历史恐慌指数曲线  
5️⃣ 阅读 AI 生成的“恐慌原因总结”

---

## 5. 系统非功能性需求

| 项目 | 目标 |
|------|------|
| 更新频率 | 每小时定时更新 |
| 清洗时间 | < 15分钟 |
| 数据延迟 | < 30分钟 |
| 安全性 | `.env` 文件管理 Tushare / DeepSeek Token |
| 日志追踪 | 所有 ETL 任务记录在 Airflow + PostgreSQL |

---

## 6. 成功标准（KPI）

| 维度 | 衡量指标 |
|------|-----------|
| 技术 | Airflow DAG 稳定运行、任务成功率 > 95% |
| 数据 | 每日更新量一致、舆情抓取率 > 90% |
| 前端 | 页面响应时间 < 2 秒 |
| 商业价值 | 能清晰呈现市场恐慌情绪变化趋势 |

---
